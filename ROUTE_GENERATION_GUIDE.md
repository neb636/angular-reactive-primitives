# Automated Route Generation Guide

This project uses an automated system to generate Angular routes from compiled documentation components.

## How It Works

The system consists of two scripts that work together:

1. **`scripts/compile-docs.js`** - Compiles `.doc.md` files into Angular components
2. **`scripts/generate-routes.js`** - Scans compiled components and generates route definitions

## Quick Start

### Creating Documentation

1. Create a `.doc.md` file next to your library source file:

   ```
   projects/reactive-primitives/src/lib/
     composables/
       my-feature/
         my-feature.composable.ts
         my-feature.doc.md       ← Create this
   ```

2. Write your documentation in markdown (see `DOC_TEMPLATE.md` for format)

3. Run the build command:

   ```bash
   npm run build:docs
   ```

4. The system automatically:
   - Compiles your `.doc.md` into a component in `projects/reference-app/src/app/pages/`
   - Scans all generated components
   - Generates route definitions in `generated-doc-routes.ts`

## Available Commands

### `npm run compile:docs`

Compiles all `.doc.md` files into Angular components.

**Output:** `projects/reference-app/src/app/pages/**/*-page.component.ts`

### `npm run generate:routes`

Scans compiled components and generates route configuration.

**Output:** `projects/reference-app/src/app/generated-doc-routes.ts`

### `npm run build:docs`

Runs both compilation and route generation in sequence.

### `npm run docs:dev`

Builds docs and starts the development server.

### `npm run docs:build`

Builds docs and creates a production build.

## File Structure & Routing

The route generator uses your file structure to organize routes:

```
projects/reactive-primitives/src/lib/
  composables/
    activated-route/
      use-route-params/
        use-route-params.composable.ts
        use-route-params.doc.md
```

**Generates route:**

```
/composables/activated-route/use-route-params
```

### Route Organization

Routes are organized by:

1. **Category** - Top-level folder (composables, effects, utils)
2. **Subcategory** - Second-level folder (activated-route, browser, general)
3. **Function name** - Derived from file name

### Examples

| Source File Location                                  | Generated Route                                 |
| ----------------------------------------------------- | ----------------------------------------------- |
| `composables/activated-route/use-route-params.doc.md` | `/composables/activated-route/use-route-params` |
| `composables/browser/use-window-size.doc.md`          | `/composables/browser/use-window-size`          |
| `composables/general/use-debounced-signal.doc.md`     | `/composables/use-debounced-signal`             |
| `effects/log-changes/log-changes.doc.md`              | `/effects/log-changes`                          |

### Route Titles

Route titles are automatically generated from file names using camelCase:

- `use-route-params.doc.md` → `useRouteParams`
- `use-window-size.doc.md` → `useWindowSize`
- `log-changes.doc.md` → `logChanges`

## Generated Files

### `generated-doc-routes.ts`

This file is **auto-generated** and should not be edited manually.

```typescript
/**
 * AUTO-GENERATED FILE - DO NOT EDIT MANUALLY
 * Generated by: scripts/generate-routes.js
 */

import { Routes } from '@angular/router';
import { UseRouteParamsPageComponent } from './pages/composables/activated-route/use-route-params-page.component';
// ... more imports

export const GENERATED_DOC_ROUTES: Routes = [
  {
    path: 'composables',
    title: 'Composables',
    children: [
      {
        path: 'activated-route',
        title: 'Activated Route',
        children: [
          {
            path: 'use-route-params',
            component: UseRouteParamsPageComponent,
            title: 'useRouteParams',
          },
          // ... more routes
        ],
      },
    ],
  },
  // ... more categories
];
```

### Using Generated Routes

In `app.routes.ts`, import and use the generated routes:

```typescript
import { GENERATED_DOC_ROUTES } from './generated-doc-routes';

export const NAVIGATION_ROUTES: Routes = [
  {
    path: 'getting-started',
    title: 'Getting Started',
    children: GETTING_STARTED_ROUTES,
  },
  ...GENERATED_DOC_ROUTES, // ← Spread generated routes
];
```

## Workflow

### Adding New Documentation

1. Create `.doc.md` file next to source file
2. Run `npm run build:docs`
3. Routes are automatically generated
4. Start dev server: `npm run docs:dev`
5. Navigate to your new route

### Modifying Documentation

1. Edit the `.doc.md` file
2. Run `npm run build:docs`
3. Component and routes are regenerated
4. Refresh browser to see changes

### Removing Documentation

1. Delete the `.doc.md` file
2. Run `npm run build:docs`
3. The component and route will be removed automatically

## Excluded Directories

The route generator skips certain directories to avoid conflicts:

- `getting-started/` - Manual pages
- `test-page/` - Development/testing pages

These directories are handled manually in `app.routes.ts`.

## Troubleshooting

### Routes not showing up

- Ensure you ran `npm run build:docs` after creating/modifying `.doc.md` files
- Check that the component was generated in `projects/reference-app/src/app/pages/`
- Verify `generated-doc-routes.ts` includes your route

### Import path errors

- Run `npm run build:docs` to regenerate with correct relative paths
- The compiler automatically calculates relative paths based on folder depth

### Build errors

- Check your markdown doesn't have `\$` - use `$` instead in code blocks
- Ensure code blocks use proper triple backticks
- Run `npm run compile:docs` to see specific compilation errors

## Customization

### Changing Category Titles

Edit the `getCategoryTitle()` function in `scripts/generate-routes.js`:

```javascript
function getCategoryTitle(category) {
  const titles = {
    composables: 'Composables',
    effects: 'Effects',
    utils: 'Utils',
    // Add your custom category here
  };
  return titles[category] || category;
}
```

### Changing Subcategory Titles

Edit the `getSubcategoryTitle()` function in `scripts/generate-routes.js`:

```javascript
function getSubcategoryTitle(subcategory) {
  const titles = {
    'activated-route': 'Activated Route',
    browser: 'Browser',
    // Add your custom subcategory here
  };
  return titles[subcategory] || subcategory;
}
```

## Architecture

```
┌─────────────────────┐
│  .doc.md files      │
│  (Source)           │
└──────────┬──────────┘
           │
           ↓
┌─────────────────────┐
│ compile-docs.js     │
│ Markdown → Angular  │
└──────────┬──────────┘
           │
           ↓
┌─────────────────────┐
│ *-page.component.ts │
│ (Generated)         │
└──────────┬──────────┘
           │
           ↓
┌─────────────────────┐
│ generate-routes.js  │
│ Scan & Generate     │
└──────────┬──────────┘
           │
           ↓
┌─────────────────────┐
│generated-doc-routes │
│ (Auto-generated)    │
└──────────┬──────────┘
           │
           ↓
┌─────────────────────┐
│   app.routes.ts     │
│   (Import & Use)    │
└─────────────────────┘
```

## Benefits

✅ **No Manual Route Management** - Routes are generated automatically from your file structure

✅ **Consistent Naming** - Route paths, titles, and component names follow conventions

✅ **Type Safety** - All generated code is TypeScript with proper imports

✅ **Automatic Organization** - Categories and subcategories are derived from folder structure

✅ **Single Source of Truth** - File structure determines routes

## Best Practices

1. **Consistent Naming** - Use kebab-case for file names
2. **Logical Organization** - Group related functions in subcategories
3. **Run build:docs** - Always run after adding/modifying docs
4. **Don't Edit Generated Files** - They will be overwritten
5. **Commit Generated Files** - Include `generated-doc-routes.ts` in version control

## Next Steps

- See `DOC_MARKDOWN_GUIDE.md` for markdown documentation format
- See `DOC_TEMPLATE.md` for a complete template
- Check `README_DOCS_SYSTEM.md` for the complete documentation system overview
